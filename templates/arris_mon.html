<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
	    <title>Arris Monitor</title>
        <script type="text/javascript" src="static/vendor/jquery.min.js"></script>
        <script type="text/javascript" src="static/vendor/smoothie.js"></script>
        <script type="text/javascript" src="static/arris_mon.js"></script>
    </head>
    <body>
        <h4> Downstream </h4>
        <table border="2" cellpadding="0" cellspacing="0" width="850">
            <tbody>
                <tr>
                    <td>SNR</td>
                    <td><canvas id="downstream_snr" width="800" height="200"></canvas></td>
                </tr>
                <tr>
                    <td>Power</td>
                    <td><canvas id="downstream_power" width="800" height="200"></canvas></td>
                </tr>
            </tbody>
        </table>

        <h4> Upstream </h4>
        <table border="2" cellpadding="0" cellspacing="0" width="850">
            <tbody>
                <tr>
                    <td>Power</td>
                    <td><canvas id="upstream_power" width="800" height="200"></canvas></td>
                </tr>
            </tbody>
        </table>

        <p>
            <a id="start_btn" href="">[Run]</a>
            <a id="reset_btn" href="">[Reset]</a>
            <a id="status_btn" href="" target="_blank">[Status]</a>
        </p>

        <script>
            new ArrisMonitor({
                url: "/status.html",
                timeout: 1000,
                downstream: {
                    charts: ["snr", "power"],
                    channels: [
                        { strokeStyle:'#00ff00', lineWidth:4 },
                        { strokeStyle:'#ffff10', lineWidth:3.5 },
                        { strokeStyle:'#ffff20', lineWidth:3 },
                        { strokeStyle:'#ffff30', lineWidth:2.5 },
                        { strokeStyle:'#ffff40', lineWidth:2 },
                        { strokeStyle:'#ffff50', lineWidth:1.5 },
                        { strokeStyle:'#ffff60', lineWidth:1 },
                        { strokeStyle:'#ffff70', lineWidth:0.5 }
                    ],
                    snr: {
                        chartOptions: {
                            interpolation: "step",
                            millisPerPixel: 50,
                            horizontalLines: [
                                {value: 33, color: '#ff7c7c', lineWidth: 1}
                            ]
                        },
                        chartCanvas: "#downstream_snr",
                        chartDelay: 1000,
                    },
                    power: {
                        chartOptions: {
                            interpolation: "step",
                            millisPerPixel: 50,
                            horizontalLines: [
                                {value: 15, color: '#ff7c7c', lineWidth: 1},
                                {value: -14, color: '#ff7c7c', lineWidth: 1}
                            ]
                        },
                        chartCanvas: "#downstream_power",
                        chartDelay: 1000,
                    },
                    parser: {
                        streamElement: "table:eq(1)",
                        dataElement: "tbody tr:has(td)",
                        parseElement: "td",
                        parse: function($td) {
                            return {
                                snr: parseFloat($td.eq(4).text().slice(0, -3)),
                                power: parseFloat($td.eq(3).text().slice(0, -5))
                            };
                        }
                    }
                },
                upstream: {
                    charts: ["power"],
                    channels: [
                        { strokeStyle:'#00ff00', lineWidth:4 },
                        { strokeStyle:'#ffff10', lineWidth:3.5 },
                        { strokeStyle:'#ffff20', lineWidth:3 },
                        { strokeStyle:'#ffff30', lineWidth:2.5 }
                    ],
                    power: {
                        chartOptions: {
                            interpolation: "step",
                            millisPerPixel: 50,
                            horizontalLines: [
                                {value: 39, color: '#ff7c7c', lineWidth: 1},
                                {value: 52, color: '#ff7c7c', lineWidth: 1}
                            ]
                        },
                        chartCanvas: "#upstream_power",
                        chartDelay: 1000,
                    },
                    parser: {
                        streamElement: "table:eq(3)",
                        dataElement: "tbody tr:has(td)",
                        parseElement: "td",
                        parse: function($td) {
                            return {
                                power: parseFloat($td.eq(3).text().slice(0, -5))
                            };
                        }
                    }
                },
                controls: {
                    startButton: "#start_btn",
                    resetButton: "#reset_btn",
                    statusButton: "#status_btn",
                }
            });
        </script>
    </body>
</html>